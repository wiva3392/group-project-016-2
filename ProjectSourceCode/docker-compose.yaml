# services:
#   db:
#     image: postgres:14
#     env_file: .env
#     expose:
#       - '5432'
#     volumes:
#       - group-project-16-2:/var/lib/postgresql/data
#       - ./init_data:/docker-entrypoint-initdb.d
#   web:
#     image: node:lts
#     user: 'node'
#     working_dir: /home/node/app
#     env_file: .env
#     environment:
#       - NODE_ENV=development
#     depends_on:
#       - db
#     ports:
#       - '3000:3000'
#     volumes:
#       - ./:/home/node/app
#     command: 'npm start'
# # This defines our volume(s), which will persist throughout startups.
# # If you want to get rid of a hanging volume, e.g. to test your database init,
# # run `docker-compose rm -v`. Note that this will remove ALL of your data, so
# # be extra sure you've made a stable backup somewhere.

name: group-project-016-2
services:
  db:
    image: postgres:14
    env_file: .env
    # expose is container-only; use ports if you need host access
    expose:
      - "5432"
    volumes:
      - pgdata:/var/lib/postgresql/data
      - ./src/init_data:/docker-entrypoint-initdb.d:ro

  web:
    image: node:lts
    user: "node"
    working_dir: /repository
    env_file: .env
    environment:
      - NODE_ENV=development
    depends_on:
      - db
    ports:
      - "3000:3000"
    volumes:
      - ./:/repository
    command: npm run testandrun

volumes:
  pgdata:
